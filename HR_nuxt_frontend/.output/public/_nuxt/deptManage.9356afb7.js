import{_ as P}from"./DialogCloseBtn.vue.1ff62fa1.js";import{_ as z}from"./AppSelect.vue.a2e355e3.js";import{_ as A}from"./AppTextField.vue.badc1057.js";import{b as n}from"./index.c17c83dc.js";import{V as k,a as w}from"./VCard.c238dd74.js";import{V as I}from"./VRow.a53f6339.js";import{V as g}from"./VCol.c943daa7.js";import{V as F}from"./VDataTable.781ea32f.js";import{d as O,c as K,a as h,b as U,i as B,e,w as a,f as d,V as y,g as C,F as R,u as q,r as f,v as J,x as Q,k as v,p as X}from"./entry.0516b5e8.js";import{V as W}from"./VDialog.83d7608d.js";import{a as $}from"./index.b416cb81.js";import{u as Z}from"./emp.b2d779b9.js";import{V as ee,a as te}from"./VTabs.eb6de54f.js";import{V as ae,a as oe}from"./VWindowItem.20662481.js";import"./VCheckboxBtn.759eed6f.js";import"./VDivider.c8eb66ff.js";import"./VSelect.c3f72c74.js";import"./VMenu.8605d140.js";import"./createSimpleFunctional.63f646df.js";import"./VAvatar.dac40cd4.js";import"./index.010e4494.js";import"./axios.28bc18a3.js";/* empty css              */const le={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},de=O({__name:"deptModal",props:["fetchData"],setup(b){const N=b,_=[{title:"사원코드",key:"empCode"},{title:"사원명",key:"empName"},{title:"고용일",key:"hireDate"},{title:"직급",key:"positionName"}],p=K(()=>n().deptRow),i=async()=>{const m={deptName:p.value.deptName,deptCode:p.value.deptCode,workplaceCode:p.value.workplaceCode};console.log(m),await n().MODIFY_DEPT(m),await N.fetchData(),n().SET_DIALOG(!1)},T=async()=>{try{const m={deptCode:p.value.deptCode,workplaceCode:p.value.workplaceCode};console.log(m),await n().REMOVE_DEPT(m),await N.fetchData(),n().SET_DIALOG(!1)}catch(m){console.error(m),alert("부서 삭제 중 오류가 발생했습니다.")}};return(m,s)=>{const u=P,V=A;return h(),U(R,null,[B("div",le,[e(W,{modelValue:d(n)().isDialog,"onUpdate:modelValue":s[3]||(s[3]=c=>d(n)().isDialog=c),"max-width":"600"},{default:a(()=>[e(u,{onClick:s[0]||(s[0]=c=>d(n)().SET_DIALOG(!1))}),e(k,{title:"부서정보"},{default:a(()=>[e(w,null,{default:a(()=>[e(I,null,{default:a(()=>[e(g,{cols:"12",sm:"6"},{default:a(()=>[e(V,{modelValue:d(p).deptCode,"onUpdate:modelValue":s[1]||(s[1]=c=>d(p).deptCode=c),label:"부서 코드",disabled:""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:a(()=>[e(V,{modelValue:d(p).deptName,"onUpdate:modelValue":s[2]||(s[2]=c=>d(p).deptName=c),label:"부서명"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d(F),{headers:_,items:d(p).empList},null,8,["items"]),e(w,{class:"d-flex justify-end flex-wrap gap-3 mt-2"},{default:a(()=>[e(y,{onClick:i},{default:a(()=>[C(" 수정 ")]),_:1}),e(y,{onClick:T},{default:a(()=>[C(" 삭제 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(k)],64)}}}),se=B("h1",{class:"mb-6"}," 부서정보관리 ",-1),Le=O({__name:"deptManage",setup(b){const N=q(),_=Z();_.loadEmpCode(),console.log("현재 로그인된 직원 코드:",_.empCode),_.empCode!=="EMP-01"&&_.empCode!=="EMP-00"&&N.push("/hr/confinement/unauthorized");const p=f([]),i=f(!1),T=f([]),m=f(""),s=f("personal-info"),u=f(""),V=f(""),c=()=>{const o=new Date;let t=o.getMonth()+1,r=o.getDate();t.toString().length===1&&(t=`0${t}`),r.toString().length===1&&(r=`0${r}`),V.value=`${o.getFullYear()}-${t}-${r}`},E=async()=>{try{await n().FIND_DEPT_MANAGE_LIST(),p.value=[...n().deptManageList]}catch(o){console.error("데이터 불러오기 중 에러:",o)}},G=[{title:"사업자명",key:"workplaceName"},{title:"부서코드",key:"deptCode"},{title:"부서명",key:"deptName"},{title:"책임자",key:"head"},{title:"부서인원",key:"count"},{title:"부서시작일",key:"deptStartDate"}],j=async()=>{await n().FETCH_WORKPLACELIST();const o=n().workplaceList||{};T.value=Object.values(o).map(t=>({title:t.workplaceName,value:{deptCode:t.workplaceCode,deptName:t.workplaceName}}))},H=async()=>{console.log(u.value.deptName),console.log(m.value);let o="0";const t=p.value;console.log(t);for(let D=0;D<t.length;D++){const l=t[D].deptCode.split("-")[1];l>o&&(o=l)}const r=`DPT-${++o}`;console.log(r);const S={deptCode:r,deptName:m.value,workplaceCode:u.value.deptCode,workplaceName:u.value.deptName,companyCode:null,deptStartDate:V.value};await n().ADD_DEPT(S),await E(),i.value=!1},Y=async o=>{await $().FETCH_DEPT_EMP_LIST(o.item.deptCode);const t={deptCode:o.item.deptCode,deptName:o.item.deptName,workplaceCode:o.item.workplaceCode,count:o.item.count,empList:$().selected_dept_Emp_List};n().SET_DEPT_ROW(t),n().SET_DIALOG(!0)};return J(()=>{E(),j(),c()}),(o,t)=>{const r=P,S=z,D=A,x=Q("MonthTap"),L=de;return h(),U(R,null,[se,e(k,null,{default:a(()=>[e(ee,{modelValue:d(s),"onUpdate:modelValue":t[0]||(t[0]=l=>v(s)?s.value=l:null),height:"70"},{default:a(()=>[e(te,{value:"personal-info"},{default:a(()=>[C(" 부서정보관리 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(k,{flat:""},{default:a(()=>[e(w,null,{default:a(()=>[e(ae,{modelValue:d(s),"onUpdate:modelValue":t[7]||(t[7]=l=>v(s)?s.value=l:null),class:"disable-tab-transition"},{default:a(()=>[e(oe,{value:"personal-info"},{default:a(()=>[e(W,{modelValue:d(i),"onUpdate:modelValue":t[6]||(t[6]=l=>v(i)?i.value=l:null),"max-width":"600"},{activator:a(({props:l})=>[e(g,{cols:"12",md:"2","offset-md":"10"},{default:a(()=>[e(y,X(l,{class:"ml-md-2",onClick:t[1]||(t[1]=M=>i.value=!0)}),{default:a(()=>[C(" 부서추가 ")]),_:2},1040)]),_:2},1024)]),default:a(()=>[e(r,{onClick:t[2]||(t[2]=l=>i.value=!1)}),e(k,{title:"부서추가"},{default:a(()=>[e(w,null,{default:a(()=>[e(I,null,{default:a(()=>[e(g,{cols:"12",sm:"6"},{default:a(()=>[e(S,{modelValue:d(u),"onUpdate:modelValue":t[3]||(t[3]=l=>v(u)?u.value=l:null),items:d(T),label:"등록할 부서명의 사업장을 선택해주세요"},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:a(()=>[e(D,{modelValue:d(m),"onUpdate:modelValue":t[4]||(t[4]=l=>v(m)?m.value=l:null),label:"등록할 부서명을 입력해주세요",placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(w,{class:"d-flex justify-end flex-wrap gap-3"},{default:a(()=>[e(y,{variant:"tonal",color:"secondary",onClick:t[5]||(t[5]=l=>i.value=!1)},{default:a(()=>[C(" Close ")]),_:1}),e(y,{onClick:H},{default:a(()=>[C(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(x)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d(F),{headers:G,items:d(p),"items-per-page":5,"onClick:row":t[8]||(t[8]=(l,M)=>Y(M))},null,8,["items"]),e(L,{"fetch-data":E})],64)}}});export{Le as default};
