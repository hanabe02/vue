import{_ as A}from"./AppTextField.vue.badc1057.js";import{H as B,d as Y,r as l,m as I,x as H,a as F,b as P,e as o,w as r,V as E,g as w,f as $,F as q,i as T,K as O}from"./entry.0516b5e8.js";import{h as y}from"./index.010e4494.js";import{V as j}from"./VRow.a53f6339.js";import{V as i}from"./VCol.c943daa7.js";import{V as K}from"./VSelect.c3f72c74.js";import{V as z}from"./VDataTable.781ea32f.js";import{V as G}from"./VAlert.d201ec9e.js";import{V as J}from"./VSnackbar.06ffd08c.js";import"./VCheckboxBtn.759eed6f.js";import"./VDivider.c8eb66ff.js";import"./axios.28bc18a3.js";/* empty css              */import"./VMenu.8605d140.js";import"./createSimpleFunctional.63f646df.js";import"./VAvatar.dac40cd4.js";const C="/edu";function M(a){return console.log("payload",a),y.post(`${C}/approReqEdu`,a)}function Q(a){return console.log("payload",a),y.get(`${C}/searchEduListByStatus`,{params:a})}function W(a){return y.delete(`${C}/removeEduList`,{params:{searchYear:a.searchYear,eduCode:a.eduCode,empCode:a.empCode,status:a.status}})}const X=B("eduStore",{state:()=>({eduList:[{deptName:"",durationOfTraining:"",empCode:"",empName:"",searchYear:"",status:""}],selEduList:[{eduCode:"",eduName:"",empCode:"",empName:"",deptCode:"",deptName:"",eduHistory:"",searchYear:"",status:""}]}),actions:{async APPRO_EDU_LIST(a){try{console.log("교육 승인요청중");const t=await M(a);return this.eduList=t.data.eduList,console.log("response.data",t.data),t.data}catch(t){throw new Error(t)}},async SEARCH_EDU_LIST_STATUS(a){try{console.log("교육 관리 승인여부 조회");const t=await Q(a);return this.selEduList=t.data,console.log("response",t.data),t.data}catch(t){throw new Error(t)}},async DELETE_EDU_LIST(a){try{return console.log("교육 관리 내역 삭제"),await W(a)}catch(t){throw new Error(t)}}}}),Z=T("h1",{class:"mb-6"},"교육 관리 및 승인요청",-1),ee=T("br",null,null,-1),Ve=Y({__name:"manage",setup(a){const t=X();l("");const m=l(""),p=l(""),f=l(""),u=l([]),g=l(null),v=l([]),D=[{title:"교육코드",key:"eduCode",width:80},{title:"교육명",key:"eduName",width:80},{title:"직원코드",key:"empCode",width:80},{title:"직원명",key:"empName",width:80},{title:"부서코드",key:"deptCode",width:80},{title:"부서명",key:"deptName",width:80},{title:"교육 이수 내역",key:"eduHistory",width:110},{title:"승인상태",key:"status",width:80},{title:"검색년도",key:"searchYear",width:80}],U=[{title:"미승인",value:"신청완료"},{title:"승인요청",value:"승인요청"},{title:"반려",value:"승인반려"},{title:"승인완료",value:"승인완료"}],_=l(!1),S=l("success"),k=l("success"),L=l("완료되었습니다."),V=()=>{u.value=[]},h=async()=>{try{const n=f.value,e=m.value,d=p.value,c={sDate:e,eDate:d,status:n};console.log(c),await t.SEARCH_EDU_LIST_STATUS(c),v.value=t.selEduList,console.log("조회 성공",v.value)}catch(n){throw new Error(n)}V()},b=async()=>{console.log("승인요청 실행",u.value);for(const n of u.value){const{searchYear:e,eduCode:d}=n,c={searchYear:e,eduCode:d,status:"승인요청"};await t.APPRO_EDU_LIST(c)}h(),V()},R=async()=>{if(console.log("삭제실행",u.value),u.value.some(e=>e.status==="승인요청"||e.status==="승인완료")){S.value="error",k.value="error",L.value="승인완료된 인사고과 정보는 수정할 수 없습니다.",_.value=!0,console.log("승인완료된 인사고과 정보는 수정할 수 없습니다.");return}try{for(const e of u.value){const{searchYear:d,eduCode:c,empCode:s,status:N}=e,x={searchYear:d,eduCode:c,empCode:s,status:N};await t.DELETE_EDU_LIST(x)}h(),await O(),V()}catch(e){console.error("삭제 중 오류 발생:",e.message)}};return I(u,n=>{console.log("[선택된 행]",n)}),(n,e)=>{const d=A,c=H("Vcard");return F(),P(q,null,[Z,o(c,null,{default:r(()=>[ee,o(j,null,{default:r(()=>[o(i,{cols:"12",sm:"3",mt:"4"},{default:r(()=>[o(d,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),type:"date",label:"시작일",placeholder:"시작일"},null,8,["modelValue"])]),_:1}),o(i,{cols:"12",sm:"3",mt:"4"},{default:r(()=>[o(d,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),type:"date",label:"종료일",placeholder:"종료일"},null,8,["modelValue"])]),_:1}),o(i,{cols:"12",md:"2"},{default:r(()=>[o(K,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=s=>f.value=s),label:"승인상태",items:U,variant:"outlined"},null,8,["modelValue"])]),_:1}),o(i,null,{default:r(()=>[o(E,{class:"ma-1",color:"primary",onClick:h},{default:r(()=>[w(" 조회 ")]),_:1}),o(E,{class:"ma-1",color:"success",onClick:b},{default:r(()=>[w(" 승인요청 ")]),_:1}),o(E,{class:"ma-1",color:"error",onClick:R},{default:r(()=>[w(" 삭제 ")]),_:1})]),_:1})]),_:1}),o($(z),{ref_key:"dataTableRef",ref:g,modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=s=>u.value=s),class:"mt-8",headers:D,items:v.value,"items-per-page":10,"show-select":"","item-value":"eduCode","return-object":""},null,8,["modelValue","items"])]),_:1}),o(J,{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=s=>_.value=s),location:"top",timeout:3e3,color:S.value},{default:r(()=>[o(G,{density:"compact",type:k.value,title:"알림",text:L.value},null,8,["type","text"])]),_:1},8,["modelValue","color"])],64)}}});export{Ve as default};
