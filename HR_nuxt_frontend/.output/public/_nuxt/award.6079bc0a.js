import{_ as W}from"./AppSelect.vue.09c264c1.js";import{_ as X}from"./DialogCloseBtn.vue.254a418a.js";import{p as Z,V as h}from"./VPagination.a86c888e.js";import{a as Y}from"./index.47132c2c.js";import{a as F}from"./index.bd5a1696.js";import{b as I}from"./index.029b96c0.js";import{s as d}from"./index.15d0fdef.js";import{d as ee,u as le,i as ae,r as n,x as te,a as oe,b as se,e as l,w as o,j as w,f as t,V as c,g as V,l as m,t as ne,F as ue}from"./entry.03463029.js";import{a as y,V as L}from"./VCard.fffe692b.js";import{V as ie}from"./VSpacer.b6acb082.js";import{V as O}from"./VDivider.d26ec686.js";import{V as me}from"./VDataTable.05c6073e.js";import{V as R}from"./VRow.32153e51.js";import{V as B}from"./VCol.80a95e6b.js";import{V as j}from"./VDialog.1a76132d.js";import{V as k}from"./VAlert.34e6bd50.js";import{V as M}from"./VSnackbar.87ec9dcb.js";import"./VCheckboxBtn.09401292.js";import"./VSelect.588c9b0b.js";import"./VMenu.e5a18272.js";import"./createSimpleFunctional.7a9430cd.js";import"./VAvatar.d681e4e5.js";import"./index.010e4494.js";import"./axios.28bc18a3.js";/* empty css              */const re=w("h1",{class:"mb-6"},"성과급 등록",-1),pe={class:"me-3 d-flex gap-3"},de={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},fe={class:"d-flex flex-wrap justify-center justify-sm-space-between gap-y-2 mt-2"},ve={class:"text-sm text-disabled mb-0"},Re=ee({__name:"award",setup(ce){const z=le(),_=ae("empCode",n(""));console.log("현재 로그인된 직원 코드:",_.value,_),_.value!=="EMP-01"&&_.value!=="EMP-00"&&z.push("/hr/confinement/unauthorized");const g=n(!1),D=n(!1),N=n(!1),r=n(""),u=n(""),C=n(""),x=n([]),U=n([]),S=n([]),A=n([]),b=n(""),E=n(""),p=n(!1),f=n(!1),H=[{title:"해당 년월",key:"applyYearMonth",align:"center"},{title:"사원 명",key:"empName",align:"center"},{title:"지급액",key:"bonus",align:"center"},{title:"분류",key:"detailCodeName",align:"center"},{title:"승인상태",key:"finalizeStatus",align:"center"}],T=[{title:"100%",value:1},{title:"200%",value:2},{title:"300%",value:3},{title:"400%",value:4},{title:"500%",value:5}],P=async()=>{const s=new Date;b.value=`${s.getFullYear()}-${s.getMonth()+1}`,E.value=`${s.getFullYear()}-${s.getMonth()}`;const e={applyYearMonth:b.value,empCode:"%",detailCodeName:"성과급",finalizeStatus:"%"};await d().FIND_BONUS(e),S.value=await d().bonusList},q=async()=>{await Y().FETCH_ALL_EMP();const s=await Y().all_emp_list;A.value=await s?Object.values(s).map(e=>({title:e.empName,value:{empCode:e.empCode,empName:e.empName}})):[]},G=async()=>{await I().FETCH_DEPTLIST_DETAIL();const s=await I().deptlistDetail;U.value=await s?Object.values(s).map(e=>({title:e.deptName,value:{empCode:e.deptCode,empName:e.empName}})):[]},J=async()=>{if(r.value===""||u.value===""||r.value===null||u.value===null)D.value=!0;else{const s={applyYearMonth:E.value,empCode:r.value.empCode};await d().SEARCH_SALARY_INIT(s);const e={applyYearMonth:b.value,empName:r.value.empName,empCode:r.value.empCode,bonus:d().initSalaryList[0].salary*u.value,bonusCode:"BON002",detailCodeName:"성과급",finalizeStatus:"N"};r.value="",u.value="",await d().ADD_BONUS(e),await P(),p.value=!1,g.value=!0}},K=async()=>{if(C.value===""||u.value===""||C.value===null||u.value===null)N.value=!0;else{await F().FETCH_EMPLIST_BY_DEPT(C.value.empCode);for(const s of F().empList){const e={applyYearMonth:E.value,empCode:s.empCode};await d().SEARCH_SALARY_INIT(e);const v={applyYearMonth:b.value,empName:s.empName,empCode:s.empCode,bonus:d().initSalaryList[0].salary*u.value,bonusCode:"BON002",detailCodeName:"성과급",finalizeStatus:"N"};await d().ADD_BONUS(v),g.value=!0}await P(),f.value=!1}},Q=()=>{x.value.forEach(s=>{const e={empCode:s,applyYearMonth:b.value,bonusCode:"BON002"};d().DELETE_BONUS(e).then(()=>P())}),p.value=!1,g.value=!0};te(()=>{P(),q(),G()});const i=n({page:1,itemsPerPage:5,sortBy:[""],sortDesc:[!1]});return(s,e)=>{const v=W,$=X;return oe(),se(ue,null,[re,l(L,null,{default:o(()=>[l(y,{class:"d-flex flex-wrap py-4 gap-4"},{default:o(()=>[w("div",pe,[l(v,{"model-value":t(i).itemsPerPage,items:[{value:5,title:"5"},{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=a=>t(i).itemsPerPage=parseInt(a,10))},null,8,["model-value"])]),l(ie),w("div",de,[l(c,{"prepend-icon":"tabler-plus",onClick:e[1]||(e[1]=a=>p.value=!0)},{default:o(()=>[V(" 성과금 등록(개인) ")]),_:1}),l(c,{"prepend-icon":"tabler-plus",onClick:e[2]||(e[2]=a=>f.value=!0)},{default:o(()=>[V(" 성과금 등록(부서) ")]),_:1}),l(c,{"prepend-icon":"tabler-minus",onClick:Q},{default:o(()=>[V(" 성과금 삭제 ")]),_:1})])]),_:1}),l(O),l(t(me),{modelValue:t(x),"onUpdate:modelValue":e[4]||(e[4]=a=>m(x)?x.value=a:null),headers:H,items:t(S),"items-per-page":t(i).itemsPerPage,page:t(i).page,options:t(i),"item-value":"empCode","show-select":""},{bottom:o(()=>[l(O),l(y,{class:"pt-2"},{default:o(()=>[w("div",fe,[w("p",ve,ne(t(Z)({page:t(i).page,itemsPerPage:t(i).itemsPerPage},t(S).length)),1),l(h,{modelValue:t(i).page,"onUpdate:modelValue":e[3]||(e[3]=a=>t(i).page=a),"total-visible":s.$vuetify.display.smAndDown?3:5,length:Math.ceil(t(S).length/t(i).itemsPerPage)},null,8,["modelValue","total-visible","length"])])]),_:1})]),_:1},8,["modelValue","items","items-per-page","page","options"])]),_:1}),l(j,{modelValue:t(p),"onUpdate:modelValue":e[9]||(e[9]=a=>m(p)?p.value=a:null),"max-width":"600"},{default:o(()=>[l($,{onClick:e[5]||(e[5]=a=>p.value=!t(p))}),l(L,{title:"성과금 등록(개인)"},{default:o(()=>[l(y,null,{default:o(()=>[l(R,null,{default:o(()=>[l(B,{cols:"12",sm:"6"},{default:o(()=>[l(v,{modelValue:t(r),"onUpdate:modelValue":e[6]||(e[6]=a=>m(r)?r.value=a:null),items:t(A),label:"사원명",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),l(B,{cols:"12",sm:"6"},{default:o(()=>[l(v,{modelValue:t(u),"onUpdate:modelValue":e[7]||(e[7]=a=>m(u)?u.value=a:null),items:T,label:"배율",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(y,{class:"d-flex justify-end flex-wrap gap-3"},{default:o(()=>[l(c,{variant:"tonal",color:"secondary",onClick:e[8]||(e[8]=a=>p.value=!1)},{default:o(()=>[V(" Close ")]),_:1}),l(c,{onClick:J},{default:o(()=>[V(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:t(f),"onUpdate:modelValue":e[14]||(e[14]=a=>m(f)?f.value=a:null),"max-width":"600"},{default:o(()=>[l($,{onClick:e[10]||(e[10]=a=>f.value=!t(f))}),l(L,{title:"성과금 등록(부서)"},{default:o(()=>[l(y,null,{default:o(()=>[l(R,null,{default:o(()=>[l(B,{cols:"12",sm:"6"},{default:o(()=>[l(v,{modelValue:t(C),"onUpdate:modelValue":e[11]||(e[11]=a=>m(C)?C.value=a:null),items:t(U),label:"부서명",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),l(B,{cols:"12",sm:"6"},{default:o(()=>[l(v,{modelValue:t(u),"onUpdate:modelValue":e[12]||(e[12]=a=>m(u)?u.value=a:null),items:T,label:"배율",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(y,{class:"d-flex justify-end flex-wrap gap-3 mt-2"},{default:o(()=>[l(c,{variant:"tonal",color:"secondary",onClick:e[13]||(e[13]=a=>f.value=!1)},{default:o(()=>[V(" Close ")]),_:1}),l(c,{onClick:K},{default:o(()=>[V(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(M,{modelValue:t(D),"onUpdate:modelValue":e[15]||(e[15]=a=>m(D)?D.value=a:null),location:"top",timeout:3e3,color:"warning"},{default:o(()=>[l(k,{density:"compact",type:"warning",title:"warning!",text:"사원명, 배율을 선택해주세요."})]),_:1},8,["modelValue"]),l(M,{modelValue:t(N),"onUpdate:modelValue":e[16]||(e[16]=a=>m(N)?N.value=a:null),location:"top",timeout:3e3,color:"warning"},{default:o(()=>[l(k,{density:"compact",type:"warning",title:"warning!",text:"부서명, 배율을 선택해주세요."})]),_:1},8,["modelValue"]),l(M,{modelValue:t(g),"onUpdate:modelValue":e[17]||(e[17]=a=>m(g)?g.value=a:null),location:"top",timeout:3e3,color:"success"},{default:o(()=>[l(k,{density:"compact",type:"success",title:"success!",text:"완료되었습니다."})]),_:1},8,["modelValue"])],64)}}});export{Re as default};
