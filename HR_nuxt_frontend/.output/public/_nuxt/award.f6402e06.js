import{_ as W}from"./AppSelect.vue.a2e355e3.js";import{_ as X}from"./DialogCloseBtn.vue.1ff62fa1.js";import{p as Z,V as h}from"./VPagination.73e79dab.js";import{a as Y}from"./index.b416cb81.js";import{a as F}from"./index.7f3ab773.js";import{b as I}from"./index.c17c83dc.js";import{s as d}from"./index.a27dba13.js";import{d as ee,u as le,r as n,v as ae,a as te,b as oe,e as l,w as o,i as w,f as t,V as c,g as V,k as m,t as se,F as ne}from"./entry.0516b5e8.js";import{u as ie}from"./emp.b2d779b9.js";import{a as y,V as k}from"./VCard.c238dd74.js";import{V as ue}from"./VSpacer.40be0b68.js";import{V as O}from"./VDivider.c8eb66ff.js";import{V as me}from"./VDataTable.781ea32f.js";import{V as R}from"./VRow.a53f6339.js";import{V as B}from"./VCol.c943daa7.js";import{V as j}from"./VDialog.83d7608d.js";import{V as L}from"./VAlert.d201ec9e.js";import{V as M}from"./VSnackbar.06ffd08c.js";import"./VCheckboxBtn.759eed6f.js";import"./VSelect.c3f72c74.js";import"./VMenu.8605d140.js";import"./createSimpleFunctional.63f646df.js";import"./VAvatar.dac40cd4.js";import"./index.010e4494.js";import"./axios.28bc18a3.js";/* empty css              */const re=w("h1",{class:"mb-6"},"성과급 등록",-1),pe={class:"me-3 d-flex gap-3"},de={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},fe={class:"d-flex flex-wrap justify-center justify-sm-space-between gap-y-2 mt-2"},ve={class:"text-sm text-disabled mb-0"},je=ee({__name:"award",setup(ce){const z=le(),_=ie();_.loadEmpCode(),console.log("현재 로그인된 직원 코드:",_.empCode),_.empCode!=="EMP-01"&&_.empCode!=="EMP-00"&&z.push("/hr/confinement/unauthorized");const g=n(!1),D=n(!1),N=n(!1),r=n(""),i=n(""),C=n(""),S=n([]),U=n([]),x=n([]),A=n([]),b=n(""),E=n(""),p=n(!1),f=n(!1),H=[{title:"해당 년월",key:"applyYearMonth",align:"center"},{title:"사원 명",key:"empName",align:"center"},{title:"지급액",key:"bonus",align:"center"},{title:"분류",key:"detailCodeName",align:"center"},{title:"승인상태",key:"finalizeStatus",align:"center"}],T=[{title:"100%",value:1},{title:"200%",value:2},{title:"300%",value:3},{title:"400%",value:4},{title:"500%",value:5}],P=async()=>{const s=new Date;b.value=`${s.getFullYear()}-${s.getMonth()+1}`,E.value=`${s.getFullYear()}-${s.getMonth()}`;const e={applyYearMonth:b.value,empCode:"%",detailCodeName:"성과급",finalizeStatus:"%"};await d().FIND_BONUS(e),x.value=await d().bonusList},q=async()=>{await Y().FETCH_ALL_EMP();const s=await Y().all_emp_list;A.value=await s?Object.values(s).map(e=>({title:e.empName,value:{empCode:e.empCode,empName:e.empName}})):[]},G=async()=>{await I().FETCH_DEPTLIST_DETAIL();const s=await I().deptlistDetail;U.value=await s?Object.values(s).map(e=>({title:e.deptName,value:{empCode:e.deptCode,empName:e.empName}})):[]},J=async()=>{if(r.value===""||i.value===""||r.value===null||i.value===null)D.value=!0;else{const s={applyYearMonth:E.value,empCode:r.value.empCode};await d().SEARCH_SALARY_INIT(s);const e={applyYearMonth:b.value,empName:r.value.empName,empCode:r.value.empCode,bonus:d().initSalaryList[0].salary*i.value,bonusCode:"BON002",detailCodeName:"성과급",finalizeStatus:"N"};r.value="",i.value="",await d().ADD_BONUS(e),await P(),p.value=!1,g.value=!0}},K=async()=>{if(C.value===""||i.value===""||C.value===null||i.value===null)N.value=!0;else{await F().FETCH_EMPLIST_BY_DEPT(C.value.empCode);for(const s of F().empList){const e={applyYearMonth:E.value,empCode:s.empCode};await d().SEARCH_SALARY_INIT(e);const v={applyYearMonth:b.value,empName:s.empName,empCode:s.empCode,bonus:d().initSalaryList[0].salary*i.value,bonusCode:"BON002",detailCodeName:"성과급",finalizeStatus:"N"};await d().ADD_BONUS(v),g.value=!0}await P(),f.value=!1}},Q=()=>{S.value.forEach(s=>{const e={empCode:s,applyYearMonth:b.value,bonusCode:"BON002"};d().DELETE_BONUS(e).then(()=>P())}),p.value=!1,g.value=!0};ae(()=>{P(),q(),G()});const u=n({page:1,itemsPerPage:5,sortBy:[""],sortDesc:[!1]});return(s,e)=>{const v=W,$=X;return te(),oe(ne,null,[re,l(k,null,{default:o(()=>[l(y,{class:"d-flex flex-wrap py-4 gap-4"},{default:o(()=>[w("div",pe,[l(v,{"model-value":t(u).itemsPerPage,items:[{value:5,title:"5"},{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=a=>t(u).itemsPerPage=parseInt(a,10))},null,8,["model-value"])]),l(ue),w("div",de,[l(c,{"prepend-icon":"tabler-plus",onClick:e[1]||(e[1]=a=>p.value=!0)},{default:o(()=>[V(" 성과금 등록(개인) ")]),_:1}),l(c,{"prepend-icon":"tabler-plus",onClick:e[2]||(e[2]=a=>f.value=!0)},{default:o(()=>[V(" 성과금 등록(부서) ")]),_:1}),l(c,{"prepend-icon":"tabler-minus",onClick:Q},{default:o(()=>[V(" 성과금 삭제 ")]),_:1})])]),_:1}),l(O),l(t(me),{modelValue:t(S),"onUpdate:modelValue":e[4]||(e[4]=a=>m(S)?S.value=a:null),headers:H,items:t(x),"items-per-page":t(u).itemsPerPage,page:t(u).page,options:t(u),"item-value":"empCode","show-select":""},{bottom:o(()=>[l(O),l(y,{class:"pt-2"},{default:o(()=>[w("div",fe,[w("p",ve,se(t(Z)({page:t(u).page,itemsPerPage:t(u).itemsPerPage},t(x).length)),1),l(h,{modelValue:t(u).page,"onUpdate:modelValue":e[3]||(e[3]=a=>t(u).page=a),"total-visible":s.$vuetify.display.smAndDown?3:5,length:Math.ceil(t(x).length/t(u).itemsPerPage)},null,8,["modelValue","total-visible","length"])])]),_:1})]),_:1},8,["modelValue","items","items-per-page","page","options"])]),_:1}),l(j,{modelValue:t(p),"onUpdate:modelValue":e[9]||(e[9]=a=>m(p)?p.value=a:null),"max-width":"600"},{default:o(()=>[l($,{onClick:e[5]||(e[5]=a=>p.value=!t(p))}),l(k,{title:"성과금 등록(개인)"},{default:o(()=>[l(y,null,{default:o(()=>[l(R,null,{default:o(()=>[l(B,{cols:"12",sm:"6"},{default:o(()=>[l(v,{modelValue:t(r),"onUpdate:modelValue":e[6]||(e[6]=a=>m(r)?r.value=a:null),items:t(A),label:"사원명",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),l(B,{cols:"12",sm:"6"},{default:o(()=>[l(v,{modelValue:t(i),"onUpdate:modelValue":e[7]||(e[7]=a=>m(i)?i.value=a:null),items:T,label:"배율",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(y,{class:"d-flex justify-end flex-wrap gap-3"},{default:o(()=>[l(c,{variant:"tonal",color:"secondary",onClick:e[8]||(e[8]=a=>p.value=!1)},{default:o(()=>[V(" Close ")]),_:1}),l(c,{onClick:J},{default:o(()=>[V(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:t(f),"onUpdate:modelValue":e[14]||(e[14]=a=>m(f)?f.value=a:null),"max-width":"600"},{default:o(()=>[l($,{onClick:e[10]||(e[10]=a=>f.value=!t(f))}),l(k,{title:"성과금 등록(부서)"},{default:o(()=>[l(y,null,{default:o(()=>[l(R,null,{default:o(()=>[l(B,{cols:"12",sm:"6"},{default:o(()=>[l(v,{modelValue:t(C),"onUpdate:modelValue":e[11]||(e[11]=a=>m(C)?C.value=a:null),items:t(U),label:"부서명",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),l(B,{cols:"12",sm:"6"},{default:o(()=>[l(v,{modelValue:t(i),"onUpdate:modelValue":e[12]||(e[12]=a=>m(i)?i.value=a:null),items:T,label:"배율",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(y,{class:"d-flex justify-end flex-wrap gap-3 mt-2"},{default:o(()=>[l(c,{variant:"tonal",color:"secondary",onClick:e[13]||(e[13]=a=>f.value=!1)},{default:o(()=>[V(" Close ")]),_:1}),l(c,{onClick:K},{default:o(()=>[V(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(M,{modelValue:t(D),"onUpdate:modelValue":e[15]||(e[15]=a=>m(D)?D.value=a:null),location:"top",timeout:3e3,color:"warning"},{default:o(()=>[l(L,{density:"compact",type:"warning",title:"warning!",text:"사원명, 배율을 선택해주세요."})]),_:1},8,["modelValue"]),l(M,{modelValue:t(N),"onUpdate:modelValue":e[16]||(e[16]=a=>m(N)?N.value=a:null),location:"top",timeout:3e3,color:"warning"},{default:o(()=>[l(L,{density:"compact",type:"warning",title:"warning!",text:"부서명, 배율을 선택해주세요."})]),_:1},8,["modelValue"]),l(M,{modelValue:t(g),"onUpdate:modelValue":e[17]||(e[17]=a=>m(g)?g.value=a:null),location:"top",timeout:3e3,color:"success"},{default:o(()=>[l(L,{density:"compact",type:"success",title:"success!",text:"완료되었습니다."})]),_:1},8,["modelValue"])],64)}}});export{je as default};
