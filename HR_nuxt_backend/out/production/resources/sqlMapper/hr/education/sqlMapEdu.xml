<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.seoulit.erp.hr.education.dao.EduDAO">

    <parameterMap type="kr.co.seoulit.erp.hr.education.to.EduTO" id="approveEdu">
        <parameter property="eduCode" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="searchYear" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="status" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
    </parameterMap>

    <update id="approReqEdu"  parameterMap="approveEdu">
        UPDATE EDU
        SET
            STATUS = #{status}
            WHERE EDU_CODE = #{eduCode}
            AND SEARCH_YEAR = #{searchYear}
    </update>

    <resultMap id="selEduResult" type="kr.co.seoulit.erp.hr.education.to.EduTO">
        <result property="eduCode" column="EDU_CODE"/>
        <result property="eduName" column="EDU_NAME"/>
        <result property="empCode" column="EMP_CODE"/>
        <result property="empName" column="EMP_NAME"/>
        <result property="deptCode" column="DEPT_CODE"/>
        <result property="deptName" column="DEPT_NAME"/>
        <result property="eduHistory" column="EDU_HISTORY"/>
        <result property="searchYear" column="SEARCH_YEAR"/>
        <result property="status" column="STATUS"/>
    </resultMap>

    <select id="selEdu" parameterType="kr.co.seoulit.erp.hr.education.to.EduTO" resultMap="selEduResult">
        SELECT
            EDU_CODE, EDU_NAME, EMP_CODE, EMP_NAME,
            DEPT_CODE, DEPT_NAME, EDU_HISTORY, SEARCH_YEAR, STATUS
        FROM
            EDU
        WHERE SEARCH_YEAR = #{searchYear}
          AND STATUS = #{status}
    </select>

    <delete id="delEdu" parameterType="kr.co.seoulit.erp.hr.education.to.EduTO">
        DELETE FROM EDU
               WHERE SEARCH_YEAR = #{searchYear}
               AND EDU_CODE = #{eduCode}
               AND EMP_CODE = #{empCode}
               AND STATUS = #{status}
    </delete>

    <select id="selectAllEduList" resultMap="selEduResult">
        SELECT
            EDU_CODE, EDU_NAME, EMP_CODE, EMP_NAME,
            DEPT_CODE, DEPT_NAME, EDU_HISTORY, SEARCH_YEAR, STATUS
        FROM EDU
        ORDER BY SEARCH_YEAR DESC, EDU_CODE
    </select>


</mapper>
